---
name: vulnerability-scanner
description: GeliÅŸmiÅŸ gÃ¼venlik aÃ§Ä±ÄŸÄ± analizi prensipleri. OWASP 2025, Tedarik Zinciri GÃ¼venliÄŸi, saldÄ±rÄ± yÃ¼zeyi haritalama, risk Ã¶nceliklendirme.
allowed-tools: Read, Glob, Grep, Bash
---

# GÃ¼venlik AÃ§Ä±ÄŸÄ± TarayÄ±cÄ± (Vulnerability Scanner)

> Bir saldÄ±rgan gibi dÃ¼ÅŸÃ¼n, bir uzman gibi savun. 2025 tehdit manzarasÄ± farkÄ±ndalÄ±ÄŸÄ±.

## ğŸ”§ Ã‡alÄ±ÅŸma ZamanÄ± Script'leri

**Otomatik doÄŸrulama iÃ§in Ã§alÄ±ÅŸtÄ±r:**

| Script | AmaÃ§ | KullanÄ±m |
|--------|------|----------|
| `scripts/security_scan.py` | Uygulanan gÃ¼venlik prensiplerini doÄŸrula | `python scripts/security_scan.py <project_path>` |

## ğŸ“‹ Referans DosyalarÄ±

| Dosya | AmaÃ§ |
|-------|------|
| [checklists.md](checklists.md) | OWASP Top 10, Auth, API, Veri koruma kontrol listeleri |

---

## 1. GÃ¼venlik UzmanÄ± Zihniyeti

### Temel Prensipler

| Prensip | Uygulama |
|---------|----------|
| **Ä°hlali Varsay** | SaldÄ±rgan zaten iÃ§erideymiÅŸÃ§esine tasarla |
| **SÄ±fÄ±r GÃ¼ven** | Asla gÃ¼venme, her zaman doÄŸrula |
| **Derinlemesine Savunma** | Birden fazla katman, tek nokta yok |
| **En Az Yetki** | YalnÄ±zca minimum gerekli eriÅŸim |
| **GÃ¼venli BaÅŸarÄ±sÄ±z Ol** | Hatada, eriÅŸimi reddet |

### Tehdit Modelleme SorularÄ±

Taramadan Ã¶nce sor:
1. Neyi koruyoruz? (VarlÄ±klar)
2. Kim saldÄ±rÄ±rdÄ±? (Tehdit aktÃ¶rleri)
3. NasÄ±l saldÄ±rÄ±rlardÄ±? (SaldÄ±rÄ± vektÃ¶rleri)
4. Etki nedir? (Ä°ÅŸ riski)

---

## 2. OWASP Top 10:2025

### Risk Kategorileri

| SÄ±ra | Kategori | DÃ¼ÅŸÃ¼nÃ¼lecekler |
|------|----------|----------------|
| **A01** | Bozuk EriÅŸim KontrolÃ¼ | Kim neye eriÅŸebilir? IDOR, SSRF |
| **A02** | GÃ¼venlik YanlÄ±ÅŸ YapÄ±landÄ±rmasÄ± | VarsayÄ±lanlar, baÅŸlÄ±klar, aÃ§Ä±ÄŸa Ã§Ä±kan servisler |
| **A03** | YazÄ±lÄ±m Tedarik Zinciri ğŸ†• | BaÄŸÄ±mlÄ±lÄ±klar, CI/CD, build bÃ¼tÃ¼nlÃ¼ÄŸÃ¼ |
| **A04** | Kriptografik BaÅŸarÄ±sÄ±zlÄ±klar | ZayÄ±f kripto, aÃ§Ä±ÄŸa Ã§Ä±kan sÄ±rlar |
| **A05** | Enjeksiyon | KullanÄ±cÄ± girdisi â†’ sistem komutlarÄ± |
| **A06** | GÃ¼vensiz TasarÄ±m | Kusurlu mimari |
| **A07** | Kimlik DoÄŸrulama BaÅŸarÄ±sÄ±zlÄ±klarÄ± | Oturum, kimlik bilgisi yÃ¶netimi |
| **A08** | BÃ¼tÃ¼nlÃ¼k BaÅŸarÄ±sÄ±zlÄ±klarÄ± | Ä°mzasÄ±z gÃ¼ncellemeler, kurcalanmÄ±ÅŸ veri |
| **A09** | Loglama & UyarÄ± | KÃ¶r noktalar, izleme yok |
| **A10** | Ä°stisnai Durumlar ğŸ†• | Hata yÃ¶netimi, fail-open durumlarÄ± |

### 2025 Anahtar DeÄŸiÅŸiklikler

```
2021 â†’ 2025 KaymalarÄ±:
â”œâ”€â”€ SSRF, A01'e (EriÅŸim KontrolÃ¼) birleÅŸtirildi
â”œâ”€â”€ A02 yÃ¼kseldi (Bulut/Container yapÄ±landÄ±rmalarÄ±)
â”œâ”€â”€ A03 YENÄ°: Tedarik Zinciri (ana odak)
â”œâ”€â”€ A10 YENÄ°: Ä°stisnai Durumlar
â””â”€â”€ Odak kaymasÄ±: KÃ¶k nedenler > Belirtiler
```

---

## 3. Tedarik Zinciri GÃ¼venliÄŸi (A03)

### SaldÄ±rÄ± YÃ¼zeyi

| VektÃ¶r | Risk | Sorulacak Soru |
|--------|------|----------------|
| **BaÄŸÄ±mlÄ±lÄ±klar** | KÃ¶tÃ¼ niyetli paketler | Yeni baÄŸÄ±mlÄ±lÄ±klarÄ± denetliyor muyuz? |
| **Lock dosyalarÄ±** | BÃ¼tÃ¼nlÃ¼k saldÄ±rÄ±larÄ± | Commit edilmiÅŸ mi? |
| **Build pipeline** | CI/CD gÃ¼venliÄŸi ihlali | Kim deÄŸiÅŸtirebilir? |
| **Registry** | Typosquatting | DoÄŸrulanmÄ±ÅŸ kaynaklar? |

### Savunma Prensipleri

- Paket bÃ¼tÃ¼nlÃ¼ÄŸÃ¼nÃ¼ doÄŸrula (checksumlar)
- VersiyonlarÄ± sabitle, gÃ¼ncellemeleri denetle
- Kritik baÄŸÄ±mlÄ±lÄ±klar iÃ§in Ã¶zel registry'ler kullan
- Artifact'leri imzala ve doÄŸrula

---

## 4. SaldÄ±rÄ± YÃ¼zeyi Haritalama

### Neyi HaritalandÄ±r

| Kategori | Elementler |
|----------|------------|
| **GiriÅŸ NoktalarÄ±** | API'ler, formlar, dosya yÃ¼klemeleri |
| **Veri AkÄ±ÅŸlarÄ±** | Girdi â†’ Ä°ÅŸlem â†’ Ã‡Ä±ktÄ± |
| **GÃ¼ven SÄ±nÄ±rlarÄ±** | Auth/authz'nin kontrol edildiÄŸi yer |
| **VarlÄ±klar** | SÄ±rlar, PII, iÅŸ verisi |

### Ã–nceliklendirme Matrisi

```
Risk = OlasÄ±lÄ±k Ã— Etki

YÃ¼ksek Etki + YÃ¼ksek OlasÄ±lÄ±k â†’ KRÄ°TÄ°K
YÃ¼ksek Etki + DÃ¼ÅŸÃ¼k OlasÄ±lÄ±k  â†’ YÃœKSEK
DÃ¼ÅŸÃ¼k Etki + YÃ¼ksek OlasÄ±lÄ±k  â†’ ORTA
DÃ¼ÅŸÃ¼k Etki + DÃ¼ÅŸÃ¼k OlasÄ±lÄ±k   â†’ DÃœÅÃœK
```

---

## 5. Risk Ã–nceliklendirme

### CVSS + BaÄŸlam

| FaktÃ¶r | AÄŸÄ±rlÄ±k | Soru |
|--------|---------|------|
| **CVSS Skoru** | Temel Ã¶nem | GÃ¼venlik aÃ§Ä±ÄŸÄ± ne kadar ciddi? |
| **EPSS Skoru** | Exploit olasÄ±lÄ±ÄŸÄ± | Exploit ediliyor mu? |
| **VarlÄ±k DeÄŸeri** | Ä°ÅŸ baÄŸlamÄ± | Risk altÄ±nda ne var? |
| **Maruziyet** | SaldÄ±rÄ± yÃ¼zeyi | Ä°nternet'e aÃ§Ä±k mÄ±? |

### Ã–nceliklendirme Karar AÄŸacÄ±

```
Aktif olarak exploit ediliyor mu (EPSS >0.5)?
â”œâ”€â”€ EVET â†’ KRÄ°TÄ°K: Hemen aksiyon
â””â”€â”€ HAYIR â†’ CVSS'i kontrol et
         â”œâ”€â”€ CVSS â‰¥9.0 â†’ YÃœKSEK
         â”œâ”€â”€ CVSS 7.0-8.9 â†’ VarlÄ±k deÄŸerini dÃ¼ÅŸÃ¼n
         â””â”€â”€ CVSS <7.0 â†’ SonrasÄ± iÃ§in planla
```

---

## 6. Ä°stisnai Durumlar (A10 - Yeni)

### Fail-Open vs Fail-Closed

| Senaryo | Fail-Open (KÃ–TÃœ) | Fail-Closed (Ä°YÄ°) |
|---------|------------------|-------------------|
| Auth hatasÄ± | EriÅŸime izin ver | EriÅŸimi reddet |
| Parsing baÅŸarÄ±sÄ±z | Girdiyi kabul et | Girdiyi reddet |
| Timeout | Sonsuza kadar tekrar dene | SÄ±nÄ±rla + iptal et |

### Neyi Kontrol Et

- TÃ¼m hatalarÄ± yakalayÄ±p gÃ¶rmezden gelen exception handler'lar
- GÃ¼venlik iÅŸlemlerinde eksik hata yÃ¶netimi
- Auth/authz'de yarÄ±ÅŸ durumlarÄ±
- Kaynak tÃ¼kenme senaryolarÄ±

---

## 7. Tarama Metodolojisi

### AÅŸama TabanlÄ± YaklaÅŸÄ±m

```
1. KEÅÄ°F
   â””â”€â”€ Hedefi anla
       â”œâ”€â”€ Teknoloji yÄ±ÄŸÄ±nÄ±
       â”œâ”€â”€ GiriÅŸ noktalarÄ±
       â””â”€â”€ Veri akÄ±ÅŸlarÄ±

2. KEÅÄ°F
   â””â”€â”€ Potansiyel sorunlarÄ± tanÄ±mla
       â”œâ”€â”€ YapÄ±landÄ±rma incelemesi
       â”œâ”€â”€ BaÄŸÄ±mlÄ±lÄ±k analizi
       â””â”€â”€ Kod deseni arama

3. ANALÄ°Z
   â””â”€â”€ DoÄŸrula ve Ã¶nceliklendir
       â”œâ”€â”€ False positive eleme
       â”œâ”€â”€ Risk puanlama
       â””â”€â”€ SaldÄ±rÄ± zinciri haritalama

4. RAPORLAMA
   â””â”€â”€ Eylem yapÄ±labilir bulgular
       â”œâ”€â”€ AÃ§Ä±k yeniden Ã¼retme adÄ±mlarÄ±
       â”œâ”€â”€ Ä°ÅŸ etkisi
       â””â”€â”€ DÃ¼zeltme rehberliÄŸi
```

---

## 8. Kod Deseni Analizi

### YÃ¼ksek Riskli Desenler

| Desen | Risk | Ne Ara |
|-------|------|--------|
| **Sorgularda string birleÅŸtirme** | Enjeksiyon | `"SELECT * FROM " + user_input` |
| **Dinamik kod yÃ¼rÃ¼tme** | RCE | `eval()`, `exec()`, `Function()` |
| **GÃ¼vensiz deserialization** | RCE | `pickle.loads()`, `unserialize()` |
| **Yol manipÃ¼lasyonu** | Traversal | Dosya yollarÄ±nda kullanÄ±cÄ± girdisi |
| **Devre dÄ±ÅŸÄ± gÃ¼venlik** | Ã‡eÅŸitli | `verify=False`, `--insecure` |

### SÄ±r Desenleri

| Tip | GÃ¶stergeler |
|-----|-------------|
| API AnahtarlarÄ± | `api_key`, `apikey`, yÃ¼ksek entropi |
| Tokenler | `token`, `bearer`, `jwt` |
| Kimlik bilgileri | `password`, `secret`, `key` |
| Bulut | `AWS_`, `AZURE_`, `GCP_` Ã¶nekleri |

---

## 9. Bulut GÃ¼venliÄŸi HususlarÄ±

### PaylaÅŸÄ±lan Sorumluluk

| Katman | Senin SorumluluÄŸun | SaÄŸlayÄ±cÄ±nÄ±n SorumluluÄŸu |
|--------|-------------------|--------------------------|
| Veri | âœ… | âŒ |
| Uygulama | âœ… | âŒ |
| OS/Runtime | Duruma BaÄŸlÄ± | Duruma BaÄŸlÄ± |
| AltyapÄ± | âŒ | âœ… |

### Buluta Ã–zgÃ¼ Kontroller

- IAM: En az yetki uygulandÄ± mÄ±?
- Depolama: Genel bucket'lar?
- AÄŸ: GÃ¼venlik gruplarÄ± sÄ±kÄ±laÅŸtÄ±rÄ±ldÄ± mÄ±?
- SÄ±rlar: Secrets manager kullanÄ±lÄ±yor mu?

---

## 10. Anti-Desenler

| âŒ Yapma | âœ… Yap |
|----------|--------|
| Anlamadan tara | Ã–nce saldÄ±rÄ± yÃ¼zeyini haritalandÄ±r |
| Her CVE'de uyar | Exploitability + varlÄ±ÄŸa gÃ¶re Ã¶nceliklendir |
| False positivelarÄ± gÃ¶rmezden gel | DoÄŸrulanmÄ±ÅŸ baseline sÃ¼rdÃ¼r |
| YalnÄ±zca belirtileri dÃ¼zelt | KÃ¶k nedenleri ele al |
| Deploy'dan Ã¶nce bir kez tara | SÃ¼rekli tarama |
| ÃœÃ§Ã¼ncÃ¼ taraf baÄŸÄ±mlÄ±lÄ±klara kÃ¶rÃ¼ kÃ¶rÃ¼ne gÃ¼ven | BÃ¼tÃ¼nlÃ¼ÄŸÃ¼ doÄŸrula, kodu denetle |

---

## 11. Raporlama Prensipleri

### Bulgu YapÄ±sÄ±

Her bulgu ÅŸunlarÄ± yanÄ±tlamalÄ±:
1. **Ne?** - AÃ§Ä±k gÃ¼venlik aÃ§Ä±ÄŸÄ± tanÄ±mÄ±
2. **Nerede?** - Tam konum (dosya, satÄ±r, uÃ§ nokta)
3. **Neden?** - KÃ¶k neden aÃ§Ä±klamasÄ±
4. **Etki?** - Ä°ÅŸ sonucu
5. **NasÄ±l dÃ¼zeltilir?** - Spesifik dÃ¼zeltme

### Ã–nem SÄ±nÄ±flandÄ±rmasÄ±

| Ã–nem | Kriter |
|------|--------|
| **Kritik** | RCE, auth bypass, toplu veri aÃ§Ä±ÄŸa Ã§Ä±kma |
| **YÃ¼ksek** | Veri aÃ§Ä±ÄŸa Ã§Ä±kma, yetki yÃ¼kseltme |
| **Orta** | SÄ±nÄ±rlÄ± kapsam, koÅŸullar gerektirir |
| **DÃ¼ÅŸÃ¼k** | Bilgilendirme, en iyi uygulama |

---

> **Unutma:** GÃ¼venlik aÃ§Ä±ÄŸÄ± taramasÄ± sorunlarÄ± bulur. Uzman dÃ¼ÅŸÃ¼nme, Ã¶nemli olanÄ± Ã¶nceliklendirir. Her zaman sor: "Bir saldÄ±rgan bununla ne yapardÄ±?"
